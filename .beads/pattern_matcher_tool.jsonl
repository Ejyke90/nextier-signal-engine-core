{"bead_id": "nnvcd_pattern_matcher_001", "type": "pattern_matcher_tool", "title": "NNVCD Pattern Matcher Tool", "version": "1.1", "created": "2025-01-11", "description": "Tool for querying Vector DB to identify historical precedents and trend deviations for new conflict reports", "tool_config": {"vector_db": {"type_primary": "Pinecone", "type_fallback": "FAISS (local)", "index_name": "nnvcd-acled-conflicts", "namespace": "nigeria-conflict-events", "index_path_fallback": "/Users/ejikeudeze/AI_Projects/nextier-nigeria-violent-conflicts-database/.beads/brain_data/nnvcd_acled_brain.index", "connection": "Via API key stored in environment variable for Pinecone, local access for FAISS"}, "query_logic": {"input_processing": {"step_1": "Extract key elements from new NNVCD conflict report (event type, actors, location, date, fatalities)", "step_2": "Generate embedding for report text using text-embedding-ada-002 model, fallback to all-MiniLM-L6-v2 if API unavailable", "step_3": "Prepare metadata filters based on location (State/LGA) and temporal proximity (±2 years from event date if available)"}, "search_parameters": {"similarity_metric_primary": "cosine_similarity", "similarity_metric_fallback": "L2_distance", "top_k_results": 10, "filtering": {"location": "Match State or LGA if specified", "temporal": "Prioritize events within ±2 years, but include older significant events if relevant", "event_type": "Weight matches with same event type higher"}, "reranking": "Rerank results by combining vector similarity with fatality scale and actor similarity", "distance_thresholds": {"close_match": {"range": "L2 distance < 0.5 OR cosine similarity > 0.85", "interpretation": "Highly similar event, likely repeat pattern", "action": "Assign as historical precedent"}, "moderate_match": {"range": "L2 distance 0.5-1.0 OR cosine similarity 0.7-0.85", "interpretation": "Related but not identical, possible evolution of pattern", "action": "Note as related event, consider for trend analysis"}, "deviation": {"range": "L2 distance > 1.0 OR cosine similarity < 0.7", "interpretation": "Significant deviation from historical patterns", "action": "Flag as potential anomaly"}}}, "output_analysis": {"historical_precedents": {"definition": "Events closely matching current report in type, location, and actors", "criteria": "Similarity score > 0.85 (cosine) OR L2 distance < 0.5 AND location match", "output": "List of top 3 matching historical events with EVENT_ID, DATE, and NOTES"}, "trend_deviations": {"definition": "Significant differences from historical patterns", "criteria": ["Similarity score < 0.7 (cosine) OR L2 distance > 1.0 for top matches", "Fatality count > 200% of historical average for similar events", "New actor type not present in historical data for location"], "output": "Flag as deviation with explanation (e.g., New Actor, Escalated Violence, Novel Event Type)"}}, "result_formatting": {"historical_link": {"field": "bead_reference", "format": "ACLED_EVENT_ID:[ID];DATE:[DATE];SIMILARITY:[SCORE];DISTANCE:[L2 if applicable]", "default": "N/A if no strong match"}, "pattern_classification": {"field": "pattern_id", "logic": "If historical precedent found, use format [TYPE]_[LOCATION]_[REGION] based on dominant trend; if deviation, prefix with ANOMALY_", "examples": ["SEASONAL_CLASH_PLATEAU_NORTH_CENTRAL", "ANOMALY_INSURGENCY_ENUGU_SOUTH_EAST"]}}}, "execution": {"trigger": "On receipt of new NNVCD conflict report", "environment": "Integrated with NNVCD analysis pipeline", "error_handling": {"vector_db_unavailable": "Fallback to local FAISS index if Pinecone down; if both unavailable, use static pattern config for basic categorization", "low_confidence_results": "Flag for human review if top match similarity < 0.6 (cosine) OR L2 distance > 1.2"}, "logging": "Record query, results, similarity scores, and distance metrics for audit"}}
